# –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –±–∞—Ç—á–µ–π

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –±–∞—Ç—á–∞ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ –∏ —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å.

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã:

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `saveResultsToSheet`
- –£–±—Ä–∞–Ω–∞ –¥–≤–æ–π–Ω–∞—è –∑–∞–ø–∏—Å—å –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏ `AVAILABLE`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ—Å—Ç—Ä–æ—á–Ω–∞—è –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `SpreadsheetApp.flush()`
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### 2. –£–ª—É—á—à–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–∞—Ç—á–µ–π
- –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –ø–µ—Ä–µ–¥ –∏ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞—É–∑–∞ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `OZON_testSaving()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –º–µ–Ω—é –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

## –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### –®–∞–≥ 1: –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Sheets —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏
2. –í –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ "üü£ OZON –ü–∞—Ä—Å–µ—Ä" ‚Üí "–¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—è–≤–∏–ª–∏—Å—å –≤ —Å—Ç—Ä–æ–∫–µ 3

### –®–∞–≥ 2: –¢–µ—Å—Ç —Å –º–∞–ª—ã–º –±–∞—Ç—á–µ–º
1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ 2-3 –∞—Ä—Ç–∏–∫—É–ª–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ
2. –í—ã–¥–µ–ª–∏—Ç–µ –∏—Ö –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–ü–∞—Ä—Å–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª—ã"
3. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –±–∞—Ç—á–∞

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
1. –í Apps Script –æ—Ç–∫—Ä–æ–π—Ç–µ View ‚Üí Logs
2. –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
   - `üîÑ –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–∞—Ç—á–∞ X...`
   - `‚úÖ –ë–∞—Ç—á X –æ–±—Ä–∞–±–æ—Ç–∞–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω`
   - `‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ X —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É`

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

–í —Ñ–∞–π–ª–µ `Config.gs` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:
- `BATCH_SIZE: 2` - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–º–∏ –±–∞—Ç—á–∞–º–∏
- `SELECTION_BATCH_SIZE: 1` - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –æ–¥–Ω–æ–º—É –∞—Ä—Ç–∏–∫—É–ª—É
- `REQUEST_DELAY: 5000` - —É–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏
- `SAVE_DELAY: 1000` - —É–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º:

1. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É
2. **–ú–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ**: –£–≤–µ–ª–∏—á—å—Ç–µ `SAVE_DELAY` –∏ `REQUEST_DELAY`
3. **–û—à–∏–±–∫–∏ API**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–æ–Ω–∫–∞—Ö"

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞:

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏ `saveResultsToSheet`:

```javascript
Logger.log('=== –ù–ê–ß–ê–õ–û –°–û–•–†–ê–ù–ï–ù–ò–Ø ===');
Logger.log(`–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${JSON.stringify(results, null, 2)}`);
Logger.log(`Mapping –∫–æ–ª–æ–Ω–æ–∫: ${JSON.stringify(this.columnMapping, null, 2)}`);
```

–ò –≤ –∫–æ–Ω—Ü–µ:
```javascript
Logger.log('=== –ö–û–ù–ï–¶ –°–û–•–†–ê–ù–ï–ù–ò–Ø ===');
```

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å —Ç–æ—á–Ω–æ –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø—ã—Ç–∞—é—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è –∏ –≤ –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏.